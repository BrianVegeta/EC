webpackJsonp([77],{1508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),a=n(23),i=n(2),o=n(2206),u=function(e){return e&&e.__esModule?e:{default:e}}(o),l=n(331),c=n(1792),s=i.publishSpaceRouter.regulationPath,f=i.publishSpaceRouter.cancelPolicyPath,d=function(e){var t=e.environment,n=e[l.REDUCER_KEY];return{environment:t,publish:n,isValid:(0,c.validateRegulationBy)(n).isValid}},p=function(e,t){var n=t.location.query,r=n.pid;return{dispatchChangeData:function(t){return e((0,l.changeData)(t))},dispatchValidate:function(){return e((0,c.validateRegulation)())},dispatchTouchPath:function(){return e((0,l.touchPath)(s(r)))},nextStep:function(){return a.browserHistory.push(f(r))}}};t.default=(0,r.connect)(d,p)(u.default)},1552:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_VALID=t.STATUS_LOADING=t.STATUS_DISABLE=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),s=r(c),f=n(3),d=r(f),p=n(519),v=r(p),y=n(14),h=r(y),b=n(5),_=r(b),g=n(1557),m=r(g),C=t.STATUS_DISABLE="STATUS_DISABLE",E=t.STATUS_LOADING="STATUS_LOADING",P=t.STATUS_VALID="STATUS_VALID",S=h.default.bind(m.default),A=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:null},n.onClickNext=n.onClickNext.bind(n),n}return u(t,e),l(t,null,[{key:"renderDisable",value:function(e){var t=e.onClick,n=e.text;return s.default.createElement("button",{className:"button "+S("button","disabled"),onClick:t},n)}},{key:"renderLoading",value:function(){var e=s.default.createElement("div",{styleName:"loading-icon"},s.default.createElement(v.default,{size:9,color:"#B8B8B8"}));return s.default.createElement("button",{className:"button "+S("button","disabled")},e,"儲存中")}},{key:"renderValid",value:function(e){var t=e.onClick,n=e.text;return s.default.createElement("button",{className:"button "+S("button","active"),onClick:t},n)}}]),l(t,[{key:"onClickNext",value:function(){var e=this.props,t=e.onClick,n=e.status,r=t;this.setState({status:n===P?E:null},r)}},{key:"render",value:function(){var e,t=this.constructor,n=t.renderDisable,r=t.renderLoading,i=t.renderValid,o=this.props.text;return(e={},a(e,C,n({onClick:this.onClickNext,text:o})),a(e,E,r()),a(e,P,i({onClick:this.onClickNext,text:o})),e)[this.state.status||this.props.status]}}]),t}(s.default.Component);A.defaultProps={text:"下一步",status:C},A.propTypes={text:d.default.string.isRequired,status:d.default.oneOf([C,E,P]),onClick:d.default.func.isRequired},t.default=(0,_.default)(A,m.default)},1553:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),s=n(3),f=r(s),d=n(11),p=r(d),v=n(5),y=r(v),h=n(1558),b=r(h),_=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.helperText,r=e.optional,a=e.children;return c.default.createElement("div",{styleName:"container"},c.default.createElement("div",{styleName:"title-container"},c.default.createElement("h2",{styleName:"title"},t,r&&c.default.createElement("span",{styleName:"titleHelper"},"（非必填）")),n&&c.default.createElement("span",{styleName:"helper"},n)),a)}}]),t}(c.default.Component);_.defaultProps={helperText:null,optional:!1},_.propTypes={children:p.default.children.isRequired,title:f.default.string.isRequired,helperText:f.default.string,optional:f.default.bool},t.default=(0,y.default)(_,b.default)},1557:function(e,t){e.exports={button:"NextStep_button_e8To5",active:"NextStep_active_2uSyl",disabled:"NextStep_disabled_dCatW","loading-icon":"NextStep_loading-icon_1tLMz"}},1558:function(e,t){e.exports={container:"FormContainer_container_2PVcv","title-container":"FormContainer_title-container_2qfVb",title:"FormContainer_title_1cLV5",titleHelper:"FormContainer_titleHelper_1Diqs",helper:"FormContainer_helper_1uffx"}},1792:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.validateAll=t.validateAllBy=t.validateCancelPolicy=t.validateCancelPolicyBy=t.validateRegulation=t.validateRegulationBy=t.validatePrice=t.validatePriceBy=t.validateAbout=t.validateAboutBy=t.validateCovers=t.validateCoversBy=void 0;var a=n(201),i=r(a),o=n(85),u=r(o),l=n(154),c=r(l),s=n(132),f=n(323),d=r(f),p=n(331),v=n(213),y=t.validateCoversBy=function(e){var t=(0,i.default)(e,{isStored:!0}).length;return{isValid:t>0,errors:[e.length,t]}},h=t.validateCovers=function(){return function(e,t){return new Promise(function(e,n){var r=t()[v.REDUCER_KEY],a=y(r),i=a.isValid,o=a.errors;i?e():n(o)})}},b=t.validateAboutBy=function(e){var t=e.title,n=e.descript,r=e.cityName,a=e.areaName,i=e.assignAddress,o=e.categoryID,l=e.tag1,s=e.tag2,f=e.tag3,p=(0,c.default)({title:t,descript:n,cityArea:""+r+a,assignAddress:i,category:o,tag1:l,tag2:s,tag3:f},{title:d.default.title,descript:d.default.descript,cityArea:d.default.cityArea,assignAddress:d.default.address,category:d.default.category,tag1:d.default.tag,tag2:d.default.tag,tag3:d.default.tag});return{isValid:(0,u.default)(p),errors:p}},_=t.validateAbout=function(){return function(e,t){return new Promise(function(e,n){var r=t()[p.REDUCER_KEY],a=r.title,i=r.descript,o=r.cityName,u=r.areaName,l=r.assignAddress,c=r.categoryID,s=r.tag1,f=r.tag2,d=r.tag3,v=b({title:a,descript:i,cityName:o,areaName:u,assignAddress:l,categoryID:c,tag1:s,tag2:f,tag3:d}),y=v.isValid,h=v.errors;y?e():n(h)})}},g=t.validatePriceBy=function(e){var t=e.chargeType,n=e.price,r=e.deposit,a=e.reservationDays,i=e.discounts;if(!t)return{isValid:!1,errors:{chargeTypeError:"請選擇一種計費方式"}};var o=parseInt(n,10)||0,l=parseInt(r,10)||0;if(o+l>f.PRICE_MAX)return{isValid:!1,errors:{totalError:"總計不得超過 "+(0,s.formatCurrency)(f.PRICE_MAX)}};var p=(0,c.default)({price:n,deposit:r,reservationDays:a},{price:d.default.price,deposit:d.default.deposit,reservationDays:d.default.serviceReservationDays});return p||i.forEach(function(e){var t=e.param,n=e.discount,r=(0,c.default)({param:t,val:n},{param:d.default.discountParam,val:d.default.discountVal(o)});(0,u.default)(p)&&(p=r)}),{isValid:(0,u.default)(p),errors:p}},m=t.validatePrice=function(){return function(e,t){return new Promise(function(e,n){var r=t()[p.REDUCER_KEY],a=g(r),i=a.isValid,o=a.errors;i?e():n(o)})}},C=t.validateRegulationBy=function(e){var t=e.regulation,n=(0,c.default)({regulation:t},{regulation:d.default.regulation});return{isValid:(0,u.default)(n),errors:n}},E=t.validateRegulation=function(){return function(e,t){return new Promise(function(e,n){var r=t()[p.REDUCER_KEY],a=C(r),i=a.isValid,o=a.errors;i?e():n(o)})}},P=t.validateCancelPolicyBy=function(e){var t=e.hasCancelPolicy,n=e.advanceDay,r=e.rate;if(!t)return{isValid:!0};var a=(0,c.default)({advanceDay:n,rate:r},{advanceDay:d.default.advanceDay,rate:d.default.rate});return{isValid:(0,u.default)(a),errors:a}},S=t.validateCancelPolicy=function(){return function(e,t){return new Promise(function(e,n){var r=t()[p.REDUCER_KEY],a=P(r),i=a.isValid,o=a.errors;i?e():n(o)})}};t.validateAllBy=function(e,t){var n=y(t),r=n.isValid,a=b(e),i=a.isValid,o=g(e),u=o.isValid,l=C(e),c=l.isValid,s=P(e),f=s.isValid;return r&&i&&u&&c&&f},t.validateAll=function(){return function(e){return new Promise(function(t,n){var r=[e(h()),e(_()),e(m()),e(E()),e(S())];Promise.all(r).then(function(e){return t(e)}).catch(function(e){return n(e)})})}}},2206:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),s=n(3),f=r(s),d=n(11),p=r(d),v=n(1553),y=r(v),h=n(527),b=r(h),_=n(1552),g=r(_),m=n(158),C=r(m),E=n(5),P=r(E),S=n(2322),A=r(S),T=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onNextStepClick=n.onNextStepClick.bind(n),n}return o(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.dispatchTouchPath()}},{key:"onNextStepClick",value:function(){var e=this,t=this.props,n=t.dispatchValidate,r=t.nextStep;n().then(function(){r()}).catch(function(){e.regulationInput.valid()})}},{key:"render",value:function(){var e=this,t=this.props,n=t.publish,r=t.dispatchChangeData,a=t.isValid,i=n.regulation;return c.default.createElement(y.default,{title:"建立分享人守則",optional:!0},c.default.createElement("div",{styleName:"form-group"},c.default.createElement(b.default,{ref:function(t){return e.regulationInput=t},placeholder:"清楚敘述您希望享用人能遵守的內容，以確保交易順利",onChange:function(e){return r({regulation:e})},value:i,constraints:C.default.regulation,minHeight:250,validateOnBlur:!0})),c.default.createElement(g.default,{status:a?_.STATUS_VALID:_.STATUS_DISABLE,onClick:this.onNextStepClick}))}}]),t}(c.default.Component);T.propTypes={publish:p.default.publish.isRequired,dispatchChangeData:f.default.func.isRequired,dispatchValidate:f.default.func.isRequired,dispatchTouchPath:f.default.func.isRequired,nextStep:f.default.func.isRequired,isValid:f.default.bool.isRequired},t.default=(0,P.default)(T,A.default)},2322:function(e,t){e.exports={"form-group":"StepRegulation_form-group_3xO4N"}}});