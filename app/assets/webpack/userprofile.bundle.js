webpackJsonp([60],{1402:function(e,t,r){"use strict";function n(e){return function(t,r){t(_()),(0,o.asyncXhrPost)("/ajax/public_user_info.json",{isShowItem:!1,uid:e},r()).then(function(n){var a=n.user_profile;t(h(a)),(0,o.asyncXhrPost)("/ajax/get_track_count.json",{uid:e},r()).then(function(e){t(y(e))}),(0,o.asyncXhrPost)("/ajax/get_comments_count.json",{uid:e},r()).then(function(e){t(E(e))});var u=r()[m],i=u.isLogin,c=u.currentUser;i&&c!==e&&(0,o.asyncXhrPost)("/ajax/check_track.json",{target_uid:e},r()).then(function(e){t(b(e))})})}}function a(e){return function(t){(0,o.asyncXhrPost)("/ajax/add_track.json",{target_uid:e}).then(function(){t(v(!0))})}}function u(e){return function(t){(0,o.asyncXhrPost)("/ajax/remove_track.json",{target_uid:e}).then(function(){t(v(!1))})}}Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateTrack=t.COMMENTS_FETCHED=t.TRACK_FETCHED=t.UPDATETRACK=t.ISTRACK=t.FETCHED=t.FETCHING=void 0,t.fetchUser=n,t.addToTrack=a,t.removeFromTrack=u;var o=r(7),i=function(e){return"USERPROFILE."+e},c=t.FETCHING=i("FETCHING"),s=t.FETCHED=i("FETCHED"),l=t.ISTRACK=i("ISTRACK"),f=t.UPDATETRACK=i("UPDATETRACK"),d=t.TRACK_FETCHED=i("TRACK_FETCHED"),p=t.COMMENTS_FETCHED=i("COMMENTS_FETCHED"),m="auth",_=function(){return{type:c}},h=function(e){return{type:s,detail:e}},b=function(e){return{type:l,isTrack:e}},v=t.UpdateTrack=function(e){return{type:f,isTrack:e}},y=function(e){return{type:d,track:e}},E=function(e){return{type:p,comments:e}},T={isFetching:!1,detail:null,comments:{owner_comments_count:0,lessee_comments_count:0},track:{tracked_user_count:0,fans_count:0},isTrack:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments[1];switch(t.type){case c:return Object.assign({},e,{isFetching:!0});case s:return Object.assign({},e,{isFetching:!1,detail:t.detail});case d:return Object.assign({},e,{track:t.track});case p:return Object.assign({},e,{comments:t.comments});case l:return Object.assign({},e,{isTrack:t.isTrack});case f:var r=t.isTrack?e.track.fans_count+1:e.track.fans_count-1;return Object.assign({},e,{isTrack:t.isTrack,track:{tracked_user_count:e.track.tracked_user_count,fans_count:r}});default:return e}}},1519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),a=r(207),u=r(2205),o=function(e){return e&&e.__esModule?e:{default:e}}(u),i=r(1402),c=function(e){var t=e.environment,r=e.userprofile,n=e.auth;return{environment:t,userprofile:r,isLogin:n.isLogin,currentUid:n.currentUser.uid}},s=function(e,t){var r=t.params;return{dispatchFetchUser:function(){return e((0,i.fetchUser)(r.uid))},dispatchAddTrack:function(){return e((0,i.addToTrack)(r.uid))},dispatchRemoveTrack:function(){return e((0,i.removeFromTrack)(r.uid))},dispatchAddToChatRoom:function(t){var r=t.uid,n=t.name,u=t.picture;return e((0,a.addToChatRoom)({uid:r,name:n,picture:u}))}}};t.default=(0,n.connect)(c,s)(o.default)},1659:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.STAR_EMPTY="STAR_EMPTY",t.STAR_HALF="STAR_HALF",t.STAR_FULL="STAR_FULL"},1709:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),s=n(c),l=r(3),f=n(l),d=r(317),p=n(d),m=r(5),_=n(m),h=r(1793),b=n(h),v=r(1768),y=n(v),E=r(1659),T=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.activeColor,r=e.score,n=e.size,a=Math.round(2*r),u=this.constructor.renderStatus;return s.default.createElement("div",{styleName:"container"},[0,2,4,6,8].map(function(e,r){return s.default.createElement(y.default,{key:""+(r+1),size:n,activeColor:t,status:u(a-e)})}))}}],[{key:"renderStatus",value:function(e){return e>=2?E.STAR_FULL:1===e?E.STAR_HALF:E.STAR_EMPTY}}]),t}(s.default.Component);T.defaultProps={activeColor:p.default.primaryColor,size:16},T.propTypes={activeColor:f.default.string,size:f.default.number,score:f.default.number.isRequired},t.default=(0,_.default)(T,b.default)},1768:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),s=n(c),l=r(3),f=n(l),d=r(1820),p=n(d),m=r(1819),_=n(m),h=r(5),b=n(h),v=r(1792),y=n(v),E=r(1659),T=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.size,r=e.status,n=e.activeColor;return s.default.createElement("div",{styleName:"container"},s.default.createElement("div",{styleName:"star-background"},s.default.createElement(p.default,{size:t,color:"#D8D8D8"})),r===E.STAR_FULL&&s.default.createElement("div",{styleName:"star-full"},s.default.createElement(p.default,{size:t,color:n})),r===E.STAR_HALF&&s.default.createElement("div",{styleName:"star-half"},s.default.createElement(_.default,{size:t,color:n})))}}]),t}(s.default.Component);T.propTypes={size:f.default.number.isRequired,activeColor:f.default.string.isRequired,status:f.default.oneOf([E.STAR_EMPTY,E.STAR_HALF,E.STAR_FULL]).isRequired},t.default=(0,b.default)(T,y.default)},1792:function(e,t){e.exports={container:"Star_container_2TDsW","star-background":"Star_star-background_1X8mD","star-full":"Star_star-full_1kVIa","star-half":"Star_star-half_346Jh"}},1793:function(e,t){e.exports={container:"Stars_container_2v0b-"}},1819:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=r(0),o=n(u),i=r(29),c=n(i),s=function(e){return o.default.createElement(c.default,a({viewBox:"0 0 40 40"},e),o.default.createElement("g",null,o.default.createElement("path",{d:"m19.2 7.2c-1.5 3.1-3.7 8-3.7 8s-5.2 0.6-8.7 1c-0.3 0-0.6 0.3-0.6 0.5-0.2 0.3 0 0.6 0.1 0.8 2.7 2.3 6.5 6 6.5 6s-1 5.2-1.8 8.7c0 0.3 0 0.6 0.3 0.8 0.4 0.3 0.7 0.3 1 0.2 3-1.7 7.7-4.4 7.7-4.4v-22.1c-0.3 0-0.7 0.3-0.8 0.5z"})))};t.default=s,e.exports=t.default},1820:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=r(0),o=n(u),i=r(29),c=n(i),s=function(e){return o.default.createElement(c.default,a({viewBox:"0 0 40 40"},e),o.default.createElement("g",null,o.default.createElement("path",{d:"m15.6 15.3l-8.8 0.9c-0.3 0.1-0.6 0.3-0.7 0.6s0 0.7 0.3 0.9c2.6 2.4 6.5 5.9 6.5 5.9 0 0-1.1 5.2-1.8 8.7-0.1 0.3 0.1 0.6 0.3 0.8 0.3 0.2 0.6 0.2 0.9 0.1 3.1-1.8 7.7-4.4 7.7-4.4s4.6 2.6 7.7 4.4c0.3 0.1 0.6 0.1 0.9-0.1 0.2-0.2 0.4-0.5 0.3-0.8-0.7-3.5-1.8-8.7-1.8-8.7l6.5-5.9c0.3-0.2 0.4-0.6 0.3-0.9s-0.4-0.5-0.7-0.6c-3.5-0.4-8.8-0.9-8.8-0.9l-3.6-8.1c-0.2-0.3-0.5-0.5-0.8-0.5s-0.6 0.2-0.8 0.5c-1.4 3.2-3.6 8.1-3.6 8.1z"})))};t.default=s,e.exports=t.default},2205:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(24),c=n(i),s=r(2322),l=n(s),f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=r(0),p=n(d),m=r(3),_=n(m),h=r(13),b=n(h),v=r(2339),y=n(v),E=r(14),T=r(130),k=r(23),g=r(2),O=r(106),j=n(O),w=r(84),R=n(w),C=r(1709),P=n(C),U=r(5),S=n(U),A=r(2313),F=n(A),N=function(e){function t(e){a(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=e.currentUid===e.params.uid;return r.state={isOwner:n},r}return o(t,e),f(t,null,[{key:"renderSubscribeCount",value:function(e){return p.default.createElement("span",{styleName:"count"},(0,T.formatCount)(e))}},{key:"renderSidebarDetailTerm",value:function(e){return p.default.createElement("div",{styleName:"detail-term"},e)}}]),f(t,[{key:"componentDidMount",value:function(){this.props.dispatchFetchUser()}},{key:"componentDidUpdate",value:function(e){var t=e.params.uid;if(!(0,c.default)(t,this.props.params.uid)){this.props.dispatchFetchUser();var r=this.props.currentUid===this.props.params.uid;this.state={isOwner:r}}}},{key:"replaceWebsite",value:function(){var e=this.props.userprofile.detail,t=e.website;return t&&"www."!==t?t:""}},{key:"renderStatic",value:function(){var e=this.state.isOwner,t=this.props,r=t.params,n=t.userprofile.track,a=this.constructor.renderSubscribeCount;return e?p.default.createElement("div",{styleName:"subscribe-count"},p.default.createElement(k.Link,{to:g.userprofilePaths.fansPath(r.uid)},p.default.createElement("span",{style:{marginRight:35}},"粉絲：",a(n.fans_count))),p.default.createElement(k.Link,{to:g.userprofilePaths.trackPath(r.uid)},p.default.createElement("span",null,"追蹤名單：",a(n.tracked_user_count)))):p.default.createElement("div",{styleName:"subscribe-count"},p.default.createElement("span",{style:{marginRight:35}},"粉絲：",a(n.fans_count)),p.default.createElement("span",null,"追蹤名單：",a(n.tracked_user_count)))}},{key:"renderChatButton",value:function(){if(this.state.isOwner)return p.default.createElement("div",{styleName:"profile-btn"},p.default.createElement(R.default,{content:"編輯",colorType:"greenBorder",onClick:function(){return k.browserHistory.push(g.my.profilePath)}}));var e=this.props,t=e.dispatchAddToChatRoom,r=e.userprofile.detail,n=r.uid,a=r.name,u=r.picture;return p.default.createElement("div",{styleName:"subscribe-btn"},p.default.createElement(R.default,{content:"私訊",colorType:"greenBorder",onClick:function(){return t({uid:n,name:a,picture:u})}}))}},{key:"renderTrackButton",value:function(){if(this.state.isOwner)return null;var e=this.props,t=e.userprofile.isTrack,r=e.isLogin,n=e.dispatchAddTrack,a=e.dispatchRemoveTrack;return p.default.createElement("div",{styleName:"subscribe-btn",style:{marginRight:20}},p.default.createElement(R.default,{content:t?"取消追蹤":"追蹤",onClick:function(){r?t?a():n():k.browserHistory.push(g.loginPath)}}))}},{key:"renderDetail",value:function(){var e=this.props.location,t=e.pathname;if((0,l.default)(t,"/track")||(0,l.default)(t,"/fans"))return null;var r=this.props.userprofile,n=r.detail,a=r.comments,u=n.autobiography,o=n.website,i=n.credit,c=a.owner_comments_count+a.lessee_comments_count;return p.default.createElement("div",null,p.default.createElement("div",{styleName:"score-container"},p.default.createElement("div",{styleName:"score"},i.toFixed(1)),p.default.createElement("div",{styleName:"stars-container"},p.default.createElement(P.default,{score:i,activeColor:"#FF9442",size:28}),p.default.createElement("div",{styleName:"comment-count"},c,"則評價"))),o&&p.default.createElement("div",{styleName:"website-container"},this.replaceWebsite()),u&&p.default.createElement("div",{styleName:"biography-container"},u))}},{key:"render",value:function(){var e=this.props.userprofile.detail;if(!e)return null;var t=e.city,r=e.area,n=e.occupation,a=e.create_time,u=e.picture,o=e.name,i=this.constructor.renderSidebarDetailTerm;return p.default.createElement("div",{styleName:"container",className:"clear"},p.default.createElement("div",{styleName:"sidebar"},p.default.createElement("div",{styleName:"about-me"},p.default.createElement(y.default,{size:18}),p.default.createElement("span",null,"關於我")),t&&r&&i(""+t+r),n&&i(n),a&&i("於 "+(0,E.formatDate)(a)+" 加入")),p.default.createElement("div",{styleName:"main-wrapper"},p.default.createElement("div",{styleName:"profile-header"},p.default.createElement("div",{styleName:"avatar"},p.default.createElement(j.default,{src:u})),p.default.createElement("div",{styleName:"detail"},p.default.createElement("div",{styleName:"detail-header"},o),p.default.createElement("div",{styleName:"subscribe"},this.renderStatic(),this.renderChatButton(),this.renderTrackButton()))),this.renderDetail(),this.props.children))}}]),t}(p.default.Component);N.defaultProps={currentUid:""},N.propTypes={userprofile:_.default.shape({detail:_.default.object,track:_.default.shape({tracked_user_count:_.default.number,fans_count:_.default.number}),comments:_.default.shape({owner_comments_count:_.default.number,lessee_comments_count:_.default.number}),isTrack:_.default.bool.isRequired}).isRequired,children:b.default.children.isRequired,dispatchFetchUser:_.default.func.isRequired,dispatchAddTrack:_.default.func.isRequired,dispatchRemoveTrack:_.default.func.isRequired,dispatchAddToChatRoom:_.default.func.isRequired,params:_.default.shape({uid:_.default.string}).isRequired,isLogin:_.default.bool.isRequired,location:_.default.shape({pathname:_.default.string}).isRequired,currentUid:_.default.string},t.default=(0,S.default)(N,F.default)},2313:function(e,t){e.exports={container:"Userprofile_container_-U4Q5",sidebar:"Userprofile_sidebar_tCXot","about-me":"Userprofile_about-me_15Ol-","detail-term":"Userprofile_detail-term_1DYg5","main-wrapper":"Userprofile_main-wrapper_GYLhx","profile-header":"Userprofile_profile-header_tyKub",avatar:"Userprofile_avatar_cnQ8R",detail:"Userprofile_detail_1jGxp","detail-header":"Userprofile_detail-header_eebkW",subscribe:"Userprofile_subscribe_1Swkx","subscribe-count":"Userprofile_subscribe-count_1WZeC",count:"Userprofile_count_1YlTF","subscribe-btn":"Userprofile_subscribe-btn_3lvBt","profile-btn":"Userprofile_profile-btn_1XUnJ","score-container":"Userprofile_score-container_3Iz3N",score:"Userprofile_score_1Yvzj","stars-container":"Userprofile_stars-container_3LvPT","comment-count":"Userprofile_comment-count_g_jdy","website-container":"Userprofile_website-container_1haaJ","biography-container":"Userprofile_biography-container_2bScK"}},2318:function(e,t){function r(e,t,r){return e===e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}e.exports=r},2322:function(e,t,r){function n(e,t,r){e=i(e),t=u(t);var n=e.length;r=void 0===r?n:a(o(r),0,n);var c=r;return(r-=t.length)>=0&&e.slice(r,c)==t}var a=r(2318),u=r(168),o=r(321),i=r(111);e.exports=n},2339:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=r(0),o=n(u),i=r(29),c=n(i),s=function(e){return o.default.createElement(c.default,a({viewBox:"0 0 40 40"},e),o.default.createElement("g",null,o.default.createElement("path",{d:"m20 23.4c4.5 0 13.4 2.1 13.4 6.6v3.4h-26.8v-3.4c0-4.5 8.9-6.6 13.4-6.6z m0-3.4c-3.7 0-6.6-3-6.6-6.6s2.9-6.8 6.6-6.8 6.6 3.1 6.6 6.8-2.9 6.6-6.6 6.6z"})))};t.default=s,e.exports=t.default}});