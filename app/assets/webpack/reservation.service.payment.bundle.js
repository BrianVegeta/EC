webpackJsonp([67],{1507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),a=n(23),o=n(2),i=n(35),u=n(2197),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c=n(328),d=n(1901),s=function(e){var t=e.environment,n=e.reservationService,r=e.personalBankInfo,a=n.paymenttype;return{environment:t,reservation:n,isAtmChoosed:a===c.PAYMENT_TYPE_ATM,atmBankName:r.bankName,isCreditCardChoosed:a===c.PAYMENT_TYPE_CREDIT_CARD,isValid:(0,d.validatePaymentBy)(n,r.isReady).isValid}},f=function(e,t){var n=t.params.pid,r=t.location.query.cid,u=function(t){return e((0,i.popupBankInfoSetup)({password:t}))},l=function(){e((0,i.popupAccessCheck)({onChecked:u}))},s=o.reservationService.paymentPath,f=o.reservationService.confirmPath;return{dispatchChooseAtm:function(){return e((0,c.changeData)({paymenttype:c.PAYMENT_TYPE_ATM}))},dispatchChooseCreditCard:function(){return e((0,c.changeData)({paymenttype:c.PAYMENT_TYPE_CREDIT_CARD}))},dispatchBankSetup:l,dispatchValidate:function(){return e((0,d.validatePayment)())},dispatchTouchPath:function(){return e((0,c.touchPath)(s(n,r)))},nextStep:function(){return a.browserHistory.push(f(n,r))}}};t.default=(0,r.connect)(s,f)(l.default)},1536:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_VALID=t.STATUS_LOADING=t.STATUS_DISABLE=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),d=r(c),s=n(3),f=r(s),p=n(520),y=r(p),m=n(15),_=r(m),h=n(5),v=r(h),b=n(1541),E=r(b),T=t.STATUS_DISABLE="STATUS_DISABLE",C=t.STATUS_LOADING="STATUS_LOADING",S=t.STATUS_VALID="STATUS_VALID",A=_.default.bind(E.default),P=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),l(t,[{key:"render",value:function(){var e,t=this.props,n=t.status,r=t.onClick,o=t.text;return(e={},a(e,T,this.constructor.renderDisable({onClick:r,text:o})),a(e,C,this.constructor.renderLoading()),a(e,S,this.constructor.renderValid({onClick:r,text:o})),e)[n]}}],[{key:"renderDisable",value:function(e){var t=e.onClick,n=e.text,r="button "+A("button","disabled");return d.default.createElement("button",{className:r,onClick:t},n)}},{key:"renderLoading",value:function(){var e=d.default.createElement("div",{styleName:"loading-icon"},d.default.createElement(y.default,{size:9,color:"#B8B8B8"})),t="button "+A("button","disabled");return d.default.createElement("button",{className:t},e,"儲存中")}},{key:"renderValid",value:function(e){var t=e.onClick,n=e.text,r="button "+A("button","active");return d.default.createElement("button",{className:r,onClick:t},n)}}]),t}(d.default.Component);P.defaultProps={text:"下一步",status:T},P.propTypes={text:f.default.string.isRequired,status:f.default.oneOf([T,C,S]),onClick:f.default.func.isRequired},t.default=(0,v.default)(P,E.default)},1537:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),d=n(3),s=r(d),f=n(14),p=r(f),y=n(5),m=r(y),_=n(1542),h=r(_),v=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.helperText,r=e.optional,a=e.children;return c.default.createElement("div",{styleName:"container"},c.default.createElement("div",{styleName:"title-container"},c.default.createElement("h2",{styleName:"title"},t,r&&c.default.createElement("span",{styleName:"titleHelper"},"（非必填）")),n&&c.default.createElement("span",{styleName:"helper"},n)),a)}}]),t}(c.default.Component);v.defaultProps={helperText:null,optional:!1},v.propTypes={children:p.default.children.isRequired,title:s.default.string.isRequired,helperText:s.default.string,optional:s.default.bool},t.default=(0,m.default)(v,h.default)},1541:function(e,t){e.exports={button:"NextStep_button_e8To5",active:"NextStep_active_2uSyl",disabled:"NextStep_disabled_dCatW","loading-icon":"NextStep_loading-icon_1tLMz"}},1542:function(e,t){e.exports={container:"FormContainer_container_2PVcv","title-container":"FormContainer_title-container_2qfVb",title:"FormContainer_title_1cLV5",titleHelper:"FormContainer_titleHelper_1Diqs",helper:"FormContainer_helper_1uffx"}},1558:function(e,t,n){function r(e,t,n,r){e=o(e)?e:l(e),n=n&&!r?u(n):0;var d=e.length;return n<0&&(n=c(d+n,0)),i(e)?n<=d&&e.indexOf(t,n)>-1:!!d&&a(e,t,n)>-1}var a=n(206),o=n(62),i=n(1570),u=n(321),l=n(1571),c=Math.max;e.exports=r},1568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(318),a=function(e){return e&&e.__esModule?e:{default:e}}(r),o=a.default.serviceDates,i=a.default.cityArea,u=a.default.address,l=a.default.storeid;t.default={dates:o,cityArea:i,address:u,storeid:l,serviceLocationType:{presence:{message:"^請選擇服務方式"}},unit:function(e){return{numericality:{notValid:"^請填數字",onlyInteger:!0,notInteger:"^請填數字",greaterThanOrEqualTo:1,notGreaterThanOrEqualTo:"^至少大於 1",lessThanOrEqualTo:e,notLessThanOrEqualTo:"^數量不可超過目前物品數量："+e}}},note:{}}},1569:function(e,t,n){function r(e,t){return a(t,function(t){return e[t]})}var a=n(155);e.exports=r},1570:function(e,t,n){function r(e){return"string"==typeof e||!o(e)&&i(e)&&a(e)==u}var a=n(71),o=n(26),i=n(60),u="[object String]";e.exports=r},1571:function(e,t,n){function r(e){return null==e?[]:a(e,o(e))}var a=n(1569),o=n(87);e.exports=r},1901:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.validateAll=t.validateAllBy=t.validateAgree=t.validateAgreeBy=t.validatePayment=t.validatePaymentBy=t.validateForm=t.validateFormBy=void 0;var a=n(1558),o=r(a),i=n(106),u=r(i),l=n(154),c=r(l),d=n(1568),s=r(d),f=n(328),p=n(214),y=t.validateFormBy=function(e,t){var n=e.leasestart,r=e.leaseend,a=e.serviceLocationType,o=e.serviceCity,i=e.serviceArea,l=e.serviceAddress,d=e.note,f=e.unit,y=t.calculate_charge_type,m=t.assign_address_type,_=t.unit,h=y===p.CHARGE_TYPE_FIX,v=a===p.ASSIGN_ADDRESS_BY_CUSTOMER,b=m.length>1,E=v?s.default.cityArea:null,T=v?s.default.address:null,C=b?s.default.serviceLocationType:null,S=y===p.CHARGE_TYPE_COUNT,A=S?s.default.unit(_):null,P=(0,c.default)({dates:n&&r&&"date",serviceLocationType:a,serviceCityArea:""+o+i,serviceAddress:l,note:d,unit:f},{dates:h?s.default.dates:null,serviceLocationType:C,serviceCityArea:E,serviceAddress:T,unit:A});return{isValid:(0,u.default)(P),errors:P}},m=t.validateForm=function(){return function(e,t){return new Promise(function(e,n){var r=t()[p.REDUCER_KEY],a=t()[f.REDUCER_KEY],o=y(a,r),i=o.isValid,u=o.errors;i?e():n(u)})}},_=t.validatePaymentBy=function(e,t){var n=e.paymenttype,r=[f.PAYMENT_TYPE_ATM,f.PAYMENT_TYPE_CREDIT_CARD],a={};return(0,o.default)(r,n)||(a.paymenttype="請選擇付款方式。"),t||(a.atm="請設定銀行帳戶。"),{isValid:(0,u.default)(a),errors:a}},h=t.validatePayment=function(){return function(e,t){return new Promise(function(e,n){var r=t()[f.REDUCER_KEY],a=t(),o=a.personalBankInfo,i=_(r,o.isReady),u=i.isValid,l=i.errors;u?e():n(l)})}},v=t.validateAgreeBy=function(e){var t=e.isAgree;return{isValid:t,errors:t?{}:{agree:"請確認以上資訊並勾選。"}}},b=t.validateAgree=function(){return function(e,t){return new Promise(function(e,n){var r=t()[f.REDUCER_KEY],a=v(r),o=a.isValid,i=a.errors;o?e():n(i)})}};t.validateAllBy=function(e,t,n){var r=y(e,t).isValid,a=_(e,n).isValid,o=v(e).isValid;return r&&a&&o},t.validateAll=function(){return function(e){return new Promise(function(t,n){var r=[e(m()),e(h()),e(b())];Promise.all(r).then(function(e){return t(e)}).catch(function(e){return n(e)})})}}},2197:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),d=n(3),s=r(d),f=n(1537),p=r(f),y=n(84),m=r(y),_=n(524),h=r(_),v=n(1536),b=r(v),E=n(209),T=r(E),C=n(15),S=r(C),A=n(5),P=r(A),k=n(2309),g=r(k),N=S.default.bind(g.default),O=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onNextStepClick=n.onNextStepClick.bind(n),n.state={paymentTypeError:"",bankInfoError:""},n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.dispatchTouchPath()}},{key:"onNextStepClick",value:function(){var e=this,t=this.props,n=t.dispatchValidate,r=t.nextStep;n().then(function(){e.setState({paymentTypeError:"",bankInfoError:""}),r()}).catch(function(t){var n=t.paymenttype,r=t.atm;e.setState({paymentTypeError:n||"",bankInfoError:r||""})})}},{key:"render",value:function(){var e=this.props,t=e.isAtmChoosed,n=e.isCreditCardChoosed,r=e.dispatchChooseAtm,a=e.dispatchChooseCreditCard,o=e.dispatchBankSetup,i=e.atmBankName,u=e.isValid,l=this.state,d=l.paymentTypeError,s=l.bankInfoError;return c.default.createElement(p.default,{title:"支付方式"},c.default.createElement("div",{role:"form"},c.default.createElement("div",{styleName:"radio-group"},c.default.createElement("div",{styleName:"radio-container"},c.default.createElement(h.default,{checked:t,onChange:r},c.default.createElement("div",{className:N("radio-label")},"ATM 銀行轉帳"),c.default.createElement("div",{className:N("label-helper")},"您可以在實體ATM或網路銀行轉帳，使用ShareApp指定的銀行帳號（虛擬帳號）"))),c.default.createElement("div",{styleName:"radio-container"},c.default.createElement(h.default,{checked:n,onChange:a},c.default.createElement("div",{className:N("radio-label")},"信用卡支付"))),c.default.createElement(T.default,{text:d,outerStyle:{margin:"10px 0"},width:"auto"})),c.default.createElement("div",{styleName:"atm-detail-container"},c.default.createElement("div",{styleName:"bank-container"},c.default.createElement("span",{styleName:"bank-name"},"銀行帳戶：",i),c.default.createElement(m.default,{colorType:"greenBorder",size:"sm",content:"查看",width:"auto",onClick:o})),c.default.createElement("div",{styleName:"helper-text"},"當交易完成後，銀行會在每週一、三，將您的收入款項轉帳至您的銀行帳戶"),c.default.createElement(T.default,{text:s,outerStyle:{margin:"10px 0"},width:"auto"})),c.default.createElement(b.default,{status:u?v.STATUS_VALID:v.STATUS_DISABLE,onClick:this.onNextStepClick})))}}]),t}(c.default.Component);O.propTypes={isAtmChoosed:s.default.bool.isRequired,atmBankName:s.default.string.isRequired,isCreditCardChoosed:s.default.bool.isRequired,dispatchChooseAtm:s.default.func.isRequired,dispatchChooseCreditCard:s.default.func.isRequired,dispatchValidate:s.default.func.isRequired,dispatchTouchPath:s.default.func.isRequired,dispatchBankSetup:s.default.func.isRequired,nextStep:s.default.func.isRequired,isValid:s.default.bool.isRequired},t.default=(0,P.default)(O,g.default)},2309:function(e,t){e.exports={"radio-group":"StepPayment_radio-group_1LdCZ","radio-container":"StepPayment_radio-container_1ZTVk","atm-detail-container":"StepPayment_atm-detail-container_dNJ2b","bank-container":"StepPayment_bank-container_sSCKU","bank-name":"StepPayment_bank-name_1BkRs","helper-text":"StepPayment_helper-text_jyyu2","radio-label":"StepPayment_radio-label_2tCcO","label-helper":"StepPayment_label-helper_-24aD"}}});