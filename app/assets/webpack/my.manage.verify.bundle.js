webpackJsonp([74],{1368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disconnectFacebook=t.connectFacebook=t.fetchUserData=t.transformData=t.reset=t.changeData=t.REDUCER_KEY=void 0;var a=n(39),r=n(7),o=(t.REDUCER_KEY="myManageVerify",function(e){return"MY.MANAGE.VERIFY."+e}),u=o("CHANGE_DATA"),c=o("RESET"),i=t.changeData=function(e){return{type:u,data:e}},l=(t.reset=function(){return{type:c}},t.transformData=function(e){return{fb_id:e.fb_id,email:e.email,phone:e.phone}}),f=(t.fetchUserData=function(){return function(e,t){(0,r.asyncXhrAuthedPost)("/ajax/get_userprofile.json",t()).then(function(t){e(i(l(t)))}).catch()}},t.connectFacebook=function(e){var t=e.userID,n=e.accessToken;return function(e,a){return new Promise(function(o,u){(0,r.asyncXhrAuthedPost)("/ajax/user_bind_facebook.json",{fb_id:t,access_token:n},a(),!0).then(function(){e(i({fb_id:t})),o()}).catch(function(e){var t=e.message;u(t)})})}},t.disconnectFacebook=function(e){var t=e.userID,n=e.accessToken;return function(e,a){return new Promise(function(o,u){(0,r.asyncXhrAuthedPost)("/ajax/user_unbind_facebook.json",{fb_id:t,access_token:n},a(),!0).then(function(){e(i({fb_id:null})),o()}).catch(function(e){var t=e.message;u(t)})})}},{data:{fb_id:null,phone:"",email:""}});t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments[1];switch(t.type){case u:return(0,a.fromJS)(e).updateIn(["data"],function(e){return e.merge(t.data)}).toJS();case c:return f;default:return e}}},1404:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=n(132),u=a(o),c=n(1368),i=n(2089),l=a(i),f=function(e){return{environment:e.environment,manage:e[c.REDUCER_KEY]}},s=function(e){var t=function(t){var n=t.userID,a=t.accessToken;return e((0,c.connectFacebook)({userID:n,accessToken:a})).then(function(){(0,u.default)((0,o.successConfig)({title:"Facebook 連結成功",text:null}))}).catch(function(e){(0,u.default)((0,o.errorConfig)({title:"Facebook 連結失敗",text:e}))})},n=function(t){var n=t.userID,a=t.accessToken;return e((0,c.disconnectFacebook)({userID:n,accessToken:a})).then(function(){(0,u.default)((0,o.successConfig)({title:"Facebook 成功取消連結",text:null}))}).catch(function(e){(0,u.default)((0,o.errorConfig)({title:"Facebook 取消連結失敗",text:e}))})};return{dispatchChangeData:function(t){return e((0,c.changeData)(t))},dispatchFetchUserData:function(){return e((0,c.fetchUserData)())},dispatchReset:function(){return e((0,c.reset)())},dispatchConnectFB:t,dispatchDisconnectFB:n}};t.default=(0,r.connect)(f,s)(l.default)},1888:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(0),l=a(i),f=n(3),s=a(f),d=n(13),p=a(d),b=n(5),h=a(b),y=n(1914),m=a(y),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.labelWidth,a=e.labelVerticalAlign;return l.default.createElement("tr",{styleName:"row"},l.default.createElement("th",{width:n,styleName:"th",style:{verticalAlign:a}},t[0]),l.default.createElement("td",{styleName:"td"},t[1]))}}]),t}(l.default.Component);_.defaultProps={labelWidth:null,labelVerticalAlign:null},_.propTypes={children:p.default.children.isRequired,labelWidth:s.default.number,labelVerticalAlign:s.default.string},t.default=(0,h.default)(_,m.default)},1889:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TableRow=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(0),l=a(i),f=n(3),s=a(f),d=n(13),p=a(d),b=n(5),h=a(b),y=n(1915),m=a(y),_=n(1888),v=a(_),g=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return l.default.createElement("table",{className:n},l.default.createElement("tbody",null,t))}}]),t}(l.default.Component);g.defaultProps={className:null},g.propTypes={children:p.default.children.isRequired,className:s.default.string},t.TableRow=v.default,t.default=(0,h.default)(g,m.default)},1914:function(e,t){e.exports={row:"TableRow_row_2b_38",th:"TableRow_th_2jYkx",td:"TableRow_td_3lWQA"}},1915:function(e,t){},2089:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(0),l=a(i),f=n(3),s=a(f),d=n(560),p=a(d),b=n(221),h=n(1889),y=a(h),m=n(564),_=a(m),v=n(563),g=a(v),E=n(17),w=a(E),k=n(5),O=a(k),R=n(2220),j=a(R),D=w.default.bind(j.default),P=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.dispatchReset(),this.props.dispatchFetchUserData()}},{key:"componentWillUnmount",value:function(){this.props.dispatchReset()}},{key:"renderFbBindingButton",value:function(e){var t=this.props,n=t.dispatchConnectFB,a=t.dispatchDisconnectFB;return e?l.default.createElement(p.default,{appId:b.FACEBOOK_APP_ID,textButton:"取消連結",cssClass:"button "+D("fb-connect"),fields:"name,email,picture",callback:a}):l.default.createElement(p.default,{appId:b.FACEBOOK_APP_ID,textButton:"連結",cssClass:"button "+D("fb-connect"),fields:"name,email,picture",callback:n})}},{key:"render",value:function(){var e=this.props,t=e.dispatchChangeData,n=e.manage.data,a=n.email,r=n.phone,o=n.fb_id;return l.default.createElement(y.default,{styleName:"form-container"},l.default.createElement(h.TableRow,{labelWidth:100,labelVerticalAlign:"top"},l.default.createElement("span",{styleName:"label"},"手機號碼"),l.default.createElement("div",{styleName:"input-container"},l.default.createElement(_.default,{value:r,afterUpdateConfirm:function(e){return t({phone:e})}}),l.default.createElement("div",{styleName:"notice"},"您與另一位用戶確認預訂後，才會顯示您的號碼，用以聯絡彼此。"))),l.default.createElement(h.TableRow,{labelVerticalAlign:"top"},l.default.createElement("span",{styleName:"label"},"電子信箱"),l.default.createElement("div",{styleName:"input-container"},l.default.createElement(g.default,{value:a,afterUpdateConfirm:function(e){return t({email:e})}}),l.default.createElement("div",{styleName:"notice"},"我們不會向其他用戶透露您個人的電子郵件地址，系統僅會在交易時寄送重要通知給您。"))),l.default.createElement(h.TableRow,null,l.default.createElement("span",{styleName:"label"},"Facebook"),l.default.createElement("div",{styleName:"input-container"},this.renderFbBindingButton(o))))}}]),t}(l.default.Component);P.propTypes={manage:s.default.shape({data:s.default.shape({email:s.default.string,phone:s.default.string,fb_id:s.default.string}).isRequired}).isRequired,dispatchChangeData:s.default.func.isRequired,dispatchFetchUserData:s.default.func.isRequired,dispatchReset:s.default.func.isRequired,dispatchConnectFB:s.default.func.isRequired,dispatchDisconnectFB:s.default.func.isRequired},t.default=(0,O.default)(P,j.default)},2220:function(e,t){e.exports={"form-container":"ManageVerify_form-container_26VoK",label:"ManageVerify_label_23wG2","input-container":"ManageVerify_input-container_2Tgz4",notice:"ManageVerify_notice_3yOC7","fb-connect":"ManageVerify_fb-connect_3vUTo"}}});