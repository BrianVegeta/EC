webpackJsonp([77],{1480:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),a=r(23),i=r(2),o=r(2168),u=function(e){return e&&e.__esModule?e:{default:e}}(o),l=r(322),c=r(1711),s=i.publishServiceRouter.regulationPath,d=i.publishServiceRouter.cancelPolicyPath,f=function(e){var t=e.environment,r=e.publish;return{environment:t,publish:r,isValid:(0,c.validateRegulationBy)(r).isValid}},p=function(e,t){var r=t.location.query,n=r.pid;return{dispatchChangeData:function(t){return e((0,l.changeData)(t))},dispatchValidate:function(){return e((0,c.validateRegulation)())},dispatchTouchPath:function(){return e((0,l.touchPath)(s(n)))},nextStep:function(){return a.browserHistory.push(d(n))}}};t.default=(0,n.connect)(f,p)(u.default)},1530:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_VALID=t.STATUS_LOADING=t.STATUS_DISABLE=void 0;var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(0),s=n(c),d=r(3),f=n(d),p=r(521),y=n(p),v=r(15),h=n(v),b=r(5),_=n(b),g=r(1535),m=n(g),C=t.STATUS_DISABLE="STATUS_DISABLE",E=t.STATUS_LOADING="STATUS_LOADING",D=t.STATUS_VALID="STATUS_VALID",P=h.default.bind(m.default),A=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),l(t,[{key:"render",value:function(){var e,t=this.props,r=t.status,n=t.onClick,i=t.text;return(e={},a(e,C,this.constructor.renderDisable({onClick:n,text:i})),a(e,E,this.constructor.renderLoading()),a(e,D,this.constructor.renderValid({onClick:n,text:i})),e)[r]}}],[{key:"renderDisable",value:function(e){var t=e.onClick,r=e.text,n="button "+P("button","disabled");return s.default.createElement("button",{className:n,onClick:t},r)}},{key:"renderLoading",value:function(){var e=s.default.createElement("div",{styleName:"loading-icon"},s.default.createElement(y.default,{size:9,color:"#B8B8B8"})),t="button "+P("button","disabled");return s.default.createElement("button",{className:t},e,"儲存中")}},{key:"renderValid",value:function(e){var t=e.onClick,r=e.text,n="button "+P("button","active");return s.default.createElement("button",{className:n,onClick:t},r)}}]),t}(s.default.Component);A.defaultProps={text:"下一步",status:C},A.propTypes={text:f.default.string.isRequired,status:f.default.oneOf([C,E,D]),onClick:f.default.func.isRequired},t.default=(0,_.default)(A,m.default)},1531:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),c=n(l),s=r(3),d=n(s),f=r(13),p=n(f),y=r(5),v=n(y),h=r(1536),b=n(h),_=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.title,r=e.helperText,n=e.optional,a=e.children;return c.default.createElement("div",{styleName:"container"},c.default.createElement("div",{styleName:"title-container"},c.default.createElement("h2",{styleName:"title"},t,n&&c.default.createElement("span",{styleName:"titleHelper"},"（非必填）")),r&&c.default.createElement("span",{styleName:"helper"},r)),a)}}]),t}(c.default.Component);_.defaultProps={helperText:null,optional:!1},_.propTypes={children:p.default.children.isRequired,title:d.default.string.isRequired,helperText:d.default.string,optional:d.default.bool},t.default=(0,v.default)(_,b.default)},1535:function(e,t){e.exports={button:"NextStep_button_e8To5",active:"NextStep_active_2uSyl",disabled:"NextStep_disabled_dCatW","loading-icon":"NextStep_loading-icon_1tLMz"}},1536:function(e,t){e.exports={container:"FormContainer_container_2PVcv","title-container":"FormContainer_title-container_2qfVb",title:"FormContainer_title_1cLV5",titleHelper:"FormContainer_titleHelper_1Diqs",helper:"FormContainer_helper_1uffx"}},1711:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.validateAll=t.validateAllBy=t.validateCancelPolicy=t.validateCancelPolicyBy=t.validateRegulation=t.validateRegulationBy=t.validatePrice=t.validatePriceBy=t.validateDelivery=t.validateDeliveryBy=t.validateAbout=t.validateAboutBy=t.validateCovers=t.validateCoversBy=void 0;var a=r(319),i=n(a),o=r(105),u=n(o),l=r(154),c=n(l),s=r(130),d=r(318),f=n(d),p=r(519),y=r(322),v=r(160),h=t.validateCoversBy=function(e){var t=(0,i.default)(e,{isStored:!0}).length;return{isValid:t>0,errors:[e.length,t]}},b=t.validateCovers=function(){return function(e,t){return new Promise(function(e,r){var n=t()[v.REDUCER_KEY],a=h(n),i=a.isValid,o=a.errors;i?e():r(o)})}},_=t.validateAboutBy=function(e){var t=e.title,r=e.descript,n=e.cityName,a=e.areaName,i=e.categoryID,o=e.tag1,l=e.tag2,s=e.tag3,d=(0,c.default)({title:t,descript:r,cityArea:""+n+a,category:i,tag1:o,tag2:l,tag3:s},{title:f.default.title,descript:f.default.descript,cityArea:f.default.cityArea,category:f.default.category,tag1:f.default.tag,tag2:f.default.tag,tag3:f.default.tag});return{isValid:(0,u.default)(d),errors:d}},g=t.validateAbout=function(){return function(e,t){return new Promise(function(e,r){var n=t()[y.REDUCER_KEY],a=n.title,i=n.descript,o=n.cityName,u=n.areaName,l=n.categoryID,c=n.tag1,s=n.tag2,d=n.tag3,f=_({title:a,descript:i,cityName:o,areaName:u,categoryID:l,tag1:c,tag2:s,tag3:d}),p=f.isValid,v=f.errors;p?e():r(v)})}},m=t.validateDeliveryBy=function(e){var t=e.assignAddressByCustomer,r=e.assignAddressByOwner,n=e.assignCity,a=e.assignArea,i=e.assignAddress;if(!r)return{isValid:!!t,errors:{optionError:"至少選擇一個選項"}};var o=(0,c.default)({assignCityArea:""+n+a,assignAddress:i},{assignCityArea:f.default.cityArea,assignAddress:f.default.address});return{isValid:(0,u.default)(o),errors:o}},C=t.validateDelivery=function(){return function(e,t){return new Promise(function(e,r){var n=t()[y.REDUCER_KEY],a=m(n),i=a.isValid,o=a.errors;i?e():r(o)})}},E=t.validatePriceBy=function(e){var t=e.chargeType,r=e.price,n=e.deposit,a=e.startDate,i=e.endDate,o=e.unit,l=e.reservationDays,y=e.discount;if(!t)return{isValid:!1,errors:{chargeTypeError:"請選擇一種計費方式"}};if((parseInt(r,10)||0)+(parseInt(n,10)||0)>d.PRICE_MAX)return{isValid:!1,errors:{totalError:"總計不得超過 "+(0,s.formatCurrency)(d.PRICE_MAX)}};var v=t===p.CHARGE_TYPE_FIX,h=v?f.default.serviceUnit:null,b=v?null:f.default.serviceReservationDays,_=v&&y?f.default.discount(r):null,g=(0,c.default)({price:r,deposit:n,startDate:a,endDate:i,unit:o,reservationDays:l,discount:y},{price:f.default.price,deposit:f.default.deposit,startDate:v?f.default.startDate:null,endDate:v?f.default.endDate:null,unit:h,reservationDays:b,discount:_});return{isValid:(0,u.default)(g),errors:g}},D=t.validatePrice=function(){return function(e,t){return new Promise(function(e,r){var n=t()[y.REDUCER_KEY],a=E(n),i=a.isValid,o=a.errors;i?e():r(o)})}},P=t.validateRegulationBy=function(e){var t=e.regulation,r=(0,c.default)({regulation:t},{regulation:f.default.regulation});return{isValid:(0,u.default)(r),errors:r}},A=t.validateRegulation=function(){return function(e,t){return new Promise(function(e,r){var n=t()[y.REDUCER_KEY],a=P(n),i=a.isValid,o=a.errors;i?e():r(o)})}},S=t.validateCancelPolicyBy=function(e){var t=e.hasCancelPolicy,r=e.advanceDay,n=e.rate;if(!t)return{isValid:!0};var a=(0,c.default)({advanceDay:r,rate:n},{advanceDay:f.default.advanceDay,rate:f.default.rate});return{isValid:(0,u.default)(a),errors:a}},T=t.validateCancelPolicy=function(){return function(e,t){return new Promise(function(e,r){var n=t()[y.REDUCER_KEY],a=S(n),i=a.isValid,o=a.errors;i?e():r(o)})}};t.validateAllBy=function(e,t){var r=h(t),n=r.isValid,a=_(e),i=a.isValid,o=m(e),u=o.isValid,l=E(e),c=l.isValid,s=P(e),d=s.isValid,f=S(e),p=f.isValid;return n&&i&&u&&c&&d&&p},t.validateAll=function(){return function(e){return new Promise(function(t,r){var n=[e(b()),e(g()),e(C()),e(D()),e(A()),e(T())];Promise.all(n).then(function(e){return t(e)}).catch(function(e){return r(e)})})}}},2168:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),c=n(l),s=r(3),d=n(s),f=r(13),p=n(f),y=r(1531),v=n(y),h=r(527),b=n(h),_=r(1530),g=n(_),m=r(156),C=n(m),E=r(5),D=n(E),P=r(2288),A=n(P),S=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onNextStepClick=r.onNextStepClick.bind(r),r}return o(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.dispatchTouchPath()}},{key:"onNextStepClick",value:function(){var e=this,t=this.props,r=t.dispatchValidate,n=t.nextStep;r().then(function(){n()}).catch(function(){e.regulationInput.valid()})}},{key:"render",value:function(){var e=this,t=this.props,r=t.publish,n=t.dispatchChangeData,a=t.isValid,i=r.regulation;return c.default.createElement(v.default,{title:"建立分享人守則",optional:!0},c.default.createElement("div",{styleName:"form-group"},c.default.createElement(b.default,{ref:function(t){return e.regulationInput=t},placeholder:"清楚敘述您希望享用人能遵守的內容，以確保交易順利",onChange:function(e){return n({regulation:e})},value:i,constraints:C.default.regulation,minHeight:250,validateOnBlur:!0})),c.default.createElement(g.default,{status:a?_.STATUS_VALID:_.STATUS_DISABLE,onClick:this.onNextStepClick}))}}]),t}(c.default.Component);S.propTypes={publish:p.default.publish.isRequired,dispatchChangeData:d.default.func.isRequired,dispatchValidate:d.default.func.isRequired,dispatchTouchPath:d.default.func.isRequired,nextStep:d.default.func.isRequired,isValid:d.default.bool.isRequired},t.default=(0,D.default)(S,A.default)},2288:function(e,t){e.exports={"form-group":"StepRegulation_form-group_3HNYC"}}});