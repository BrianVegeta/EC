%h1 REGISTRATION
= @registration.errors.inspect
= form_for @registration,  url: iot_sharepay_register_path,
                    method: :post, as: :payment,
                    html: { id: :register_form } do |f|
  .input-group
    = f.radio_button :identify_by, :email
    = f.text_field :register_email, disabled: !@registration.identify_by_email?
  .input-group
    = f.radio_button :identify_by, :phone
    = f.text_field :register_phone, disabled: !@registration.identify_by_phone?
  .input-group
    = f.text_field :password
  .input-group
    = f.text_field :password_confirmation
  .input-group
    = f.text_field :name
  = render partial: 'payment', locals: { f: f }
  = f.submit '註冊', class: 'button'

:javascript
  var $identifyByEmail = document.getElementById('payment_identify_by_email');
  var $identifyByPhone = document.getElementById('payment_identify_by_phone');
  var $emailInput = document.getElementById('payment_register_email');
  var $phoneInput = document.getElementById('payment_register_phone');
  var switchOnEmail = function() {
    $phoneInput.setAttribute('disabled', 'disabled');
    $emailInput.removeAttribute('disabled');
  };
  var switchOnPhone = function() {
    $emailInput.setAttribute('disabled', 'disabled');
    $phoneInput.removeAttribute('disabled');
  }
  $identifyByEmail.addEventListener('change', function(e) {
    switchOnEmail();
  });
  if ($identifyByEmail.checked) {
    switchOnEmail();
  }

  $identifyByPhone.addEventListener('change', function(e) {
    switchOnPhone();
  });
  if ($identifyByPhone.checked) {
    switchOnPhone();
  }
